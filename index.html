<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Mini App</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>YouTube Mini Player</h1>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Введите название видео...">
        </div>
        <div class="video-list" id="videoList"></div>
        <div id="player"></div>
    </div>

    <!-- JavaScript код -->
    <script>
        // Замените на ваш YouTube API ключ!
        const YT_API_KEY = 'AIzaSyCCOqb3-LZZSfzHESrMIBAZhmlY3MFVkmc'; 

        // 1. Загрузка YouTube IFrame API
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);

        // 2. Инициализация плеера
        let player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '360',
                width: '640',
                playerVars: {
                    'autoplay': 0,
                    'controls': 1
                }
            });
        }

        // 3. Поиск видео
        async function searchVideos(query) {
            if (!query) {
                document.getElementById('videoList').innerHTML = '';
                return;
            }

            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=5&q=${encodeURIComponent(query)}&key=${YT_API_KEY}&type=video`
                );
                const data = await response.json();
                showResults(data.items);
            } catch (error) {
                console.error("Ошибка:", error);
                document.getElementById('videoList').innerHTML = '<p>Не удалось загрузить результаты</p>';
            }
        }

        // 4. Отображение результатов
        function showResults(videos) {
            const list = document.getElementById('videoList');
            list.innerHTML = videos.map(video => `
                <div class="video-item" data-id="${video.id.videoId}">
                    <img src="${video.snippet.thumbnails.medium.url}" class="thumbnail">
                    <div class="details">
                        <h3>${video.snippet.title}</h3>
                        <p>${video.snippet.channelTitle}</p>
                    </div>
                </div>
            `).join('');

            // 5. Обработчик выбора видео
            document.querySelectorAll('.video-item').forEach(item => {
                item.addEventListener('click', () => {
                    const videoId = item.dataset.id;
                    player.loadVideoById(videoId);
                });
            });
        }

        // 6. Поиск с задержкой
        let searchTimer;
        document.getElementById('searchInput').addEventListener('input', (e) => {
            clearTimeout(searchTimer);
            searchTimer = setTimeout(() => searchVideos(e.target.value), 500);
        });
    </script>
</body>
</html>
